import os
import random
import re
import uuid
import lxml
from lxml import html
from csv import DictWriter
import openpyxl
import time
from datetime import datetime,timedelta
import json
import requests
import datetime
import os
from csv import DictWriter
import re
import openpyxl
import requests
import lxml

import time
import datetime
# from adidas_proxy import AdidasProxy
from datetime import datetime
import json
import re
import uuid
import lxml
from lxml import html
from csv import DictWriter
import openpyxl
import time
from datetime import datetime
import json
import requests
import datetime
import datetime
start=time.time()
# from adidas_proxy import AdidasProxy
import os
import pandas as pd

from requests.auth import HTTPProxyAuth

start = time.time()
# from adidas_proxy import AdidasProxy

DominNam = 'https://www.footlocker.de'

html_file_Store_name = "footlocker_de_file.html"

new_header = {'authority': 'www.footlocker.de',
              'method': 'GET',
              'path': '/de/',
              'scheme': 'https',
              'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9',
              'accept-encoding': 'gzip, deflate, br',
              'accept-language': 'en-US,en;q=0.9',
              'cache-control': 'max-age=0',
              'cookie': '_crbx=342ae7ad-b4cb-4ed7-a4ac-547f179921e4; OptanonAlertBoxClosed=2022-03-07T10:35:57.787Z; _ga=GA1.2.1544562571.1646649359; sc.UserId=aa8a7fa3-c973-4f7c-9c2a-0e72926aae6a; __zlcmid=18skl19HuUH5ntC; at_check=true; JSESSIONID=ebrsk0xi4jmi1haon72e6molt.fzcxwefapipdb428882; AMCVS_40A3741F578E26BA7F000101%40AdobeOrg=1; AMCV_40A3741F578E26BA7F000101%40AdobeOrg=-1124106680%7CMCIDTS%7C19062%7CMCMID%7C01448885920566735574540511058720288020%7CMCAAMLH-1647494432%7C12%7CMCAAMB-1647494432%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1646896832s%7CNONE%7CvVersion%7C5.2.0; mboxEdgeCluster=37; s_vs=1; s_lv_s=Less%20than%207%20days; s_pr_tbe65=1646889635117; s_cc=true; userStatus=guest; userVIP=unknown; _gid=GA1.2.1813657836.1646889637; sc.ASP.NET_SESSIONID=rabrv4rqvwnxo424fnsgl43m; OptanonConsent=isGpcEnabled=0&datestamp=Thu+Mar+10+2022+10%3A56%3A38+GMT%2B0530+(India+Standard+Time)&version=6.29.0&isIABGlobal=false&hosts=&landingPath=NotLandingPage&groups=C0001%3A1%2CC0002%3A1%2CC0003%3A1%2CC0004%3A0&geolocation=%3B&AwaitingReconsent=false; datadome=lmAl1THVp_h3sI6hjQc6nOkzGmIuRhTuM9hbV5atY9phIT9_7jxS.-BUcB1oQhrhZRAoL9EJcWsrIvoK0QjL6Ytcswa1Nf~Ac5l0ZrI38d6CAI2MZfg9XBU6GjkC~FS; aa_pageHistory=[{"n":"de: FLDE: W: Category: Brands: Adidas","t":"Brand","p":"/de/category/brands/adidas.html"},{"n":"de: FLDE: W: Homepage","t":"Home","p":"/de/"}]; s_lv=1646891276673; s_sq=%5B%5BB%5D%5D; mbox=PC#c79beded644d46f093a8e4c7f1ef8238.37_0#1710136078|session#b27ff6ef573f491b8e40f170ea6eda74#1646893138',
              'sec-ch-ua': '" Not A;Brand";v="99", "Chromium";v="99", "Google Chrome";v="99"',
              'sec-ch-ua-mobile': '?0',
              'sec-ch-ua-platform': "Windows",
              'sec-fetch-dest': 'document',
              'sec-fetch-mode': 'navigate',
              'sec-fetch-site': 'same-origin',
              'sec-fetch-user': '?1',
              'upgrade-insecure-requests': '1',
              'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.51 Safari/537.36'}

site_id1 = []
Cat_url1 = []
website1 = []
country1 = []
details_dict = {}


def store_data_in_csv(dict):
    df=pd.DataFrame.from_dict(dict)
    df.to_csv('14-output.csv',mode="a+",header=False,index=False)
    fieldnames = ['Website', 'Country', 'Category ID', 'Page ID', 'Category URL', 'SKU_ID', 'PDP URL',
                  'Date_&_TimeStamp', 'Cache Page']
    # with open('Footlocker_de_ass_2003_final.csv', 'a+', encoding='utf-8-sig', newline='') as file:
    #     writer = DictWriter(file, fieldnames=fieldnames)
    #     #writer.writeheader()
    #     writer.writerows(dict)
    #     file.close()


def store_in_json(dict):
    with open("Footlocker_assor101.json", "w") as outfile:
        json.dump(dict, outfile)


#

# list_input=json.loads(scaping_inputs())
# print(list_input)
# exit()
def html_cache_page_saving(sku, saving_data):
    #now = datetime.now()
    datazone = datetime.datetime.now()
    f_date = datazone.strftime("%d_%m_%Y")
    strdate = datazone.day
    strm = datazone.month
    stry = datazone.year
    pageid = sku
    cpid = pageid + '_' + str(strdate) + '_' + str(strm) + '_' + str(stry)
    # ASS_folder = f"E:\ADIDAS_SavePages\Jdsports_uk\ASS"

    ASS_folder = f"\\\\ecxus440\\E$\\ADIDAS_SavePages\\Footlocker_DE\\ASS"
    sos_date_wise_folder = ASS_folder + f"\\{f_date}"
    if os.path.exists(sos_date_wise_folder):
        pass
    else:
        os.mkdir(sos_date_wise_folder)
    sos_filename = sos_date_wise_folder + "\\" + cpid + ".html"
    sos_filename = sos_filename.replace("+", "_").replace("-", "_")
    page_path = sos_filename.replace('/', '')
    print(page_path)
    page_path = page_path.replace('\\\\ecxus440\\E$\\ADIDAS_SavePages\\','https:////ecxus440.eclerx.com//cachepages//').replace('\\', '//').replace('//', '/')
    print(page_path)

    if os.path.exists(sos_filename):
        with open(sos_filename, 'w', encoding='utf-8') as f:
            f.write(saving_data)
    else:
        with open(sos_filename, 'w', encoding='utf-8') as f:
            f.write(saving_data)
    return page_path


path = r'Assortment_input.xlsx'

def extract_xl():
    workbook = openpyxl.load_workbook(path)
    sheet_obj = workbook.active
    all_rows = sheet_obj.max_row

    inputdata = []
    for i in range(1, all_rows):
        pdp_url = sheet_obj.cell(row=i + 1, column=4)
        sku_id = sheet_obj.cell(row=i + 1, column=3)
        country = sheet_obj.cell(row=i + 1, column=2)
        website_name = sheet_obj.cell(row=i + 1, column=1)

        u_data = [pdp_url.value, sku_id.value, country.value, website_name.value]
        # u_data=str(pdp_url.value)+'&*&'+str(sku_id.value)+'&*&'+str(country.value)+'&*&'+str(website_name.value)

        inputdata.append(u_data)
    # print(inputdata)
    return inputdata


# print(extract_xl())


# pr = AdidasProxy()
#now = datetime
dom = 'https://www.footlocker.de'

#p1=['154.28.67.108','154.28.67.112','154.28.67.120','154.28.67.121','154.28.67.124','154.28.67.144','154.28.67.146','154.28.67.154','154.28.67.170','154.28.67.175','154.28.67.178','154.28.67.185','154.28.67.186','154.28.67.187','154.28.67.188','154.28.67.195','154.28.67.2','154.28.67.21','154.28.67.224','154.28.67.235','154.28.67.24','154.28.67.242','154.28.67.246','154.28.67.251','154.28.67.31','154.28.67.33','154.28.67.34','154.28.67.40','154.28.67.46','154.28.67.51','154.28.67.59','154.28.67.77','154.28.67.78','154.28.67.84','154.28.67.92','154.28.67.93','154.29.2.106','154.29.2.110','154.29.2.134','154.29.2.141','154.29.2.155','154.29.2.167','154.29.2.171','154.29.2.177','154.29.2.18','154.29.2.185','154.29.2.190','154.29.2.197','154.29.2.199','154.29.2.201','154.29.2.211','154.29.2.213','154.29.2.217','154.29.2.233','154.29.2.246','154.29.2.247','154.29.2.249','154.29.2.252','154.29.2.254','154.29.2.28','154.29.2.34','154.29.2.38','154.29.2.54','154.29.2.56','154.29.2.58','154.29.2.69','154.29.2.76','154.29.2.77','154.29.2.79','154.29.2.94','154.29.2.98','154.37.76.110','154.37.76.116','154.37.76.129','154.37.76.151','154.37.76.156','154.37.76.162','154.37.76.165','154.37.76.17','154.37.76.178','154.37.76.182','154.37.76.202','154.37.76.203','154.37.76.208','154.37.76.217','154.37.76.237','154.37.76.239','154.37.76.244','154.37.76.247','154.37.76.252','154.37.76.26','154.37.76.27','154.37.76.34','154.37.76.40','154.37.76.46','154.37.76.5','154.37.76.52','154.37.76.63','154.37.76.68','154.37.76.76','154.37.76.78','154.37.76.81','154.37.76.84','154.37.76.88','154.37.76.89','154.37.76.92','154.7.230.108','154.7.230.110','154.7.230.114','154.7.230.115','154.7.230.116','154.7.230.118','154.7.230.120','154.7.230.125','154.7.230.13','154.7.230.158','154.7.230.159','154.7.230.186','154.7.230.187','154.7.230.192','154.7.230.193','154.7.230.207','154.7.230.210','154.7.230.212','154.7.230.214','154.7.230.229','154.7.230.234','154.7.230.248','154.7.230.26','154.7.230.28','154.7.230.3','154.7.230.31','154.7.230.37','154.7.230.40','154.7.230.48','154.7.230.49','154.7.230.50','154.7.230.63','154.7.230.91','154.7.230.92','154.7.230.94','23.131.8.10','23.131.8.100','23.131.8.105','23.131.8.106','23.131.8.123','23.131.8.126','23.131.8.135','23.131.8.142','23.131.8.15','23.131.8.154','23.131.8.156','23.131.8.157','23.131.8.18','23.131.8.180','23.131.8.190','23.131.8.200','23.131.8.218','23.131.8.222','23.131.8.223','23.131.8.224','23.131.8.227','23.131.8.229','23.131.8.23','23.131.8.234','23.131.8.244','23.131.8.247','23.131.8.37','23.131.8.42','23.131.8.50','23.131.8.54','23.131.8.63','23.131.8.7','23.131.8.75','23.131.8.77','23.131.8.85','23.131.8.92','38.75.72.109','38.75.72.110','38.75.72.125','38.75.72.133','38.75.72.134','38.75.72.136','38.75.72.153','38.75.72.154','38.75.72.166','38.75.72.167','38.75.72.17','38.75.72.170','38.75.72.173','38.75.72.179','38.75.72.195','38.75.72.202','38.75.72.205','38.75.72.208','38.75.72.213','38.75.72.214','38.75.72.236','38.75.72.242','38.75.72.246','38.75.72.254','38.75.72.32','38.75.72.44','38.75.72.46','38.75.72.47','38.75.72.52','38.75.72.57','38.75.72.60','38.75.72.61','38.75.72.62','38.75.72.88','38.75.72.91','38.75.72.97','38.75.73.122','38.75.73.132','38.75.73.150','38.75.73.156','38.75.73.162','38.75.73.175','38.75.73.182','38.75.73.183','38.75.73.193','38.75.73.202','38.75.73.205','38.75.73.206','38.75.73.211','38.75.73.219','38.75.73.231','38.75.73.235','38.75.73.243','38.75.73.251','38.75.73.30','38.75.73.34','38.75.73.35','38.75.73.38','38.75.73.42','38.75.73.50','38.75.73.55','38.75.73.61','38.75.73.64','38.75.73.7','38.75.73.74','38.75.73.75','38.75.73.87','38.75.73.92','38.75.73.94','38.75.73.95','38.75.73.96','38.75.73.97','38.75.74.129','38.75.74.13','38.75.74.138','38.75.74.139','38.75.74.141','38.75.74.146','38.75.74.152','38.75.74.153','38.75.74.161','38.75.74.167','38.75.74.186','38.75.74.187','38.75.74.195','38.75.74.196','38.75.74.197','38.75.74.20','38.75.74.203','38.75.74.204','38.75.74.206','38.75.74.21','38.75.74.222','38.75.74.227','38.75.74.233','38.75.74.234','38.75.74.237','38.75.74.241','38.75.74.27','38.75.74.30','38.75.74.36','38.75.74.50','38.75.74.57','38.75.74.85','38.75.74.9','38.75.74.93','38.75.74.96','38.75.74.97','38.75.75.108','38.75.75.115','38.75.75.121','38.75.75.128','38.75.75.131','38.75.75.136','38.75.75.140','38.75.75.142','38.75.75.145','38.75.75.146','38.75.75.154','38.75.75.159','38.75.75.165','38.75.75.176','38.75.75.183','38.75.75.185','38.75.75.197','38.75.75.20','38.75.75.202','38.75.75.215','38.75.75.219','38.75.75.226','38.75.75.23','38.75.75.230','38.75.75.243','38.75.75.245','38.75.75.25','38.75.75.33','38.75.75.38','38.75.75.45','38.75.75.47','38.75.75.54','38.75.75.67','38.75.75.73','38.75.75.78','38.75.75.86','38.96.156.101','38.96.156.105','38.96.156.114','38.96.156.119','38.96.156.134','38.96.156.135','38.96.156.148','38.96.156.154','38.96.156.157','38.96.156.158','38.96.156.174','38.96.156.175','38.96.156.181','38.96.156.187','38.96.156.19','38.96.156.200','38.96.156.205','38.96.156.210','38.96.156.215','38.96.156.216','38.96.156.224','38.96.156.229','38.96.156.244','38.96.156.245','38.96.156.250','38.96.156.251','38.96.156.3','38.96.156.42','38.96.156.43','38.96.156.44','38.96.156.51','38.96.156.55','38.96.156.62','38.96.156.64','38.96.156.68','38.96.156.86','38.96.157.101','38.96.157.105','38.96.157.108','38.96.157.109','38.96.157.110','38.96.157.122','38.96.157.131','38.96.157.137','38.96.157.139','38.96.157.143','38.96.157.151','38.96.157.157','38.96.157.16','38.96.157.162','38.96.157.168','38.96.157.170','38.96.157.171','38.96.157.186','38.96.157.190','38.96.157.192','38.96.157.233','38.96.157.237','38.96.157.24','38.96.157.25','38.96.157.32','38.96.157.35','38.96.157.36','38.96.157.42','38.96.157.45','38.96.157.58','38.96.157.61','38.96.157.68','38.96.157.76','38.96.157.78','38.96.157.79','38.96.158.108','38.96.158.111','38.96.158.113','38.96.158.119','38.96.158.12','38.96.158.126','38.96.158.13','38.96.158.132','38.96.158.139','38.96.158.144','38.96.158.155','38.96.158.173','38.96.158.174','38.96.158.175','38.96.158.178','38.96.158.194','38.96.158.195','38.96.158.208','38.96.158.21','38.96.158.226','38.96.158.23','38.96.158.246','38.96.158.25','38.96.158.253','38.96.158.30','38.96.158.32','38.96.158.35','38.96.158.38','38.96.158.55','38.96.158.60','38.96.158.70','38.96.158.77','38.96.158.79','38.96.158.83','38.96.158.86','38.96.158.9','38.96.159.10','38.96.159.117','38.96.159.12','38.96.159.123','38.96.159.151','38.96.159.155','38.96.159.163','38.96.159.164','38.96.159.166','38.96.159.169','38.96.159.18','38.96.159.195','38.96.159.208','38.96.159.220','38.96.159.222','38.96.159.235','38.96.159.237','38.96.159.241','38.96.159.242','38.96.159.252','38.96.159.31','38.96.159.34','38.96.159.35','38.96.159.39','38.96.159.40','38.96.159.47','38.96.159.50','38.96.159.53','38.96.159.59','38.96.159.6','38.96.159.61','38.96.159.63','38.96.159.64','38.96.159.66','38.96.159.83','38.96.159.95','66.207.180.10','66.207.180.100','66.207.180.107','66.207.180.11','66.207.180.111','66.207.180.115','66.207.180.116','66.207.180.134','66.207.180.146','66.207.180.164','66.207.180.17','66.207.180.179','66.207.180.181','66.207.180.204','66.207.180.207','66.207.180.215','66.207.180.230','66.207.180.232','66.207.180.244','66.207.180.245','66.207.180.26','66.207.180.27','66.207.180.31','66.207.180.42','66.207.180.43','66.207.180.44','66.207.180.53','66.207.180.63','66.207.180.65','66.207.180.73','66.207.180.75','66.207.180.83','66.207.180.84','66.207.180.87','66.207.180.90','66.207.180.95','104.218.195.130','104.218.195.205','104.251.82.191','104.251.82.240','104.251.82.63','104.251.84.104','104.251.84.217','104.251.84.232','104.251.85.123','104.251.85.196','104.251.86.162','104.251.86.167','104.251.86.209','104.251.90.200','104.251.90.237','104.251.90.69','104.251.91.154','104.251.91.233','104.251.92.178','104.251.92.234','104.251.92.63','108.177.131.182','108.177.131.25','146.19.55.151','146.19.55.167','154.13.200.241','154.13.200.34','154.13.200.48','154.13.201.156','154.13.201.245','154.13.202.117','154.13.202.128','154.13.202.146','154.13.203.144','154.13.203.212','154.13.204.132','154.13.204.98','154.13.205.173','154.13.205.40','154.13.206.167','154.13.206.181','154.13.207.213','154.13.207.233','154.13.244.123','154.13.244.139','154.13.244.234','154.13.245.128','154.13.245.133','154.13.245.152','154.13.246.157','154.13.246.158','154.13.246.159','154.13.247.187','154.13.247.219','154.13.247.42','154.13.248.163','154.13.248.36','154.13.248.95','154.13.249.100','154.13.249.42','154.13.250.164','154.13.250.89','154.13.251.141','154.13.251.52','154.13.251.76','154.13.252.114','154.13.252.163','154.13.252.79','154.13.253.101','154.13.253.185','154.13.253.195','154.13.254.141','154.13.254.99','154.13.255.222','154.13.255.248','154.17.157.182','154.17.157.234','154.17.157.50','154.17.188.153','154.17.188.24','154.17.189.230','154.17.189.30','154.29.2.16','154.29.2.196','154.29.2.231','154.37.72.173','154.37.72.59','154.37.76.117','154.37.76.137','154.37.76.187','158.115.224.142','158.115.224.246','158.115.225.241','158.115.225.253','158.115.226.137','158.115.226.92','158.115.227.120','158.115.227.174','165.140.224.123','165.140.224.184','165.140.225.115','165.140.225.230','165.140.225.46','165.140.226.14','165.140.226.244','165.140.226.46','165.140.227.12','165.140.227.245','168.91.64.213','168.91.64.234','168.91.64.251','168.91.65.46','168.91.65.73','168.91.66.106','168.91.66.123','168.91.67.109','168.91.67.17','168.91.84.133','168.91.84.59','168.91.85.212','168.91.85.30','168.91.86.14','168.91.86.21','168.91.87.79','168.91.87.97','168.91.88.214','168.91.88.245','168.91.90.127','168.91.90.49','172.255.93.114','172.255.93.130','172.255.94.155','172.255.94.158','173.208.27.32','173.208.27.93','173.208.28.162','173.208.28.246','173.234.244.244','173.234.244.79','173.245.75.175','173.245.75.54','173.245.85.105','173.245.85.116','173.245.85.45','173.245.90.138','173.245.90.224','185.255.196.162','185.255.196.168','185.255.197.105','185.255.197.110','198.251.92.13','198.251.92.237','198.251.92.29','198.251.93.165','198.251.93.227','198.251.93.237','207.230.104.136','207.230.104.195','207.230.104.90','207.230.105.118','207.230.105.205','207.230.105.84','207.230.106.19','207.230.106.198','207.230.106.204','207.230.107.92','207.230.107.95','213.109.148.122','213.109.148.23','23.105.0.165','23.105.0.224','23.105.0.63','23.105.142.171','23.105.142.57','23.105.143.213','23.105.143.73','23.105.144.123','23.105.144.96','23.105.145.215','23.105.145.242','23.105.146.181','23.105.146.245','23.105.147.152','23.105.147.192','23.105.147.203','23.105.150.11','23.105.150.199','23.105.151.138','23.105.151.3','23.105.3.42','23.105.3.68','23.105.4.172','23.105.4.231','23.106.16.106','23.106.16.203','23.106.18.234','23.106.18.44','23.106.20.181','23.106.20.233','23.106.22.125','23.106.22.147','23.106.24.173','23.106.24.41','23.106.26.65','23.106.26.84','23.106.27.13','23.106.27.139','23.106.27.144','23.106.28.230','23.106.28.237','23.106.30.117','23.106.30.126','23.110.166.102','23.110.166.26','23.110.166.76','23.110.169.100','23.110.169.162','23.110.173.171','23.110.173.225','23.129.136.120','23.129.136.245','23.129.40.19','23.129.40.44','23.129.40.76','23.129.56.191','23.129.56.237','23.161.3.146','23.161.3.67','23.170.144.104','23.170.144.108','23.170.144.19','23.170.145.103','23.170.145.252','23.170.145.51','23.175.176.21','23.175.176.24','23.175.177.176','23.175.177.183','23.175.177.8','23.176.49.110','23.176.49.183','23.177.240.144','23.177.240.217','23.177.240.90','23.184.144.105','23.184.144.124','23.184.144.231','23.185.112.167','23.185.112.229','23.185.144.110','23.185.144.171','23.185.144.197','23.185.80.164','23.185.80.4','23.185.80.6','23.186.48.210','23.186.48.248','23.226.16.211','23.226.16.243','23.226.17.178','23.226.17.240','23.226.18.106','23.226.18.193','23.226.19.212','23.226.19.87','23.226.20.187','23.226.20.90','23.226.21.13','23.226.21.22','23.226.22.216','23.226.22.53','23.226.23.178','23.226.23.250','23.226.24.190','23.226.24.6','23.226.24.64','23.226.25.107','23.226.25.68','23.226.26.158','23.226.26.202','23.226.26.220','23.226.27.246','23.226.27.94','23.226.28.159','23.226.28.194','23.226.28.231','23.226.29.126','23.226.29.99','23.226.30.191','23.226.30.235','23.226.31.131','23.226.31.169','23.226.31.193','23.247.172.197','23.247.172.214','23.247.172.51','23.247.173.202','23.247.173.6','23.247.174.196','23.247.174.211','23.247.174.81','23.247.175.156','23.247.175.215','23.247.175.218','23.27.9.103','23.27.9.228','23.82.105.11','23.82.105.194','23.82.105.45','23.82.109.165','23.82.109.242','23.82.184.118','23.82.184.227','23.82.184.80','23.82.186.178','23.82.186.223','23.82.40.136','23.82.40.202','23.82.40.42','23.82.41.119','23.82.41.40','23.82.41.6','23.82.44.209','23.82.44.48','23.82.80.145','23.82.80.68','23.82.81.171','23.82.81.79','45.146.117.234','45.146.117.253','45.146.118.204','45.146.118.228','45.146.119.223','45.146.119.244','45.154.141.33','45.154.141.50','45.154.142.21','45.154.142.231','45.154.142.42','45.224.228.187','45.224.228.87','45.224.228.94','45.224.230.211','45.224.230.228','45.224.231.141','45.224.231.68','45.237.84.117','45.237.84.33','45.237.86.170','45.237.86.178','45.238.157.141','45.238.157.198','45.238.157.225','45.238.159.115','45.238.159.59','45.238.159.8','45.59.128.144','45.59.128.198','45.59.128.236','45.59.129.177','45.59.129.217','45.59.130.16','45.59.130.218','45.59.131.107','45.59.131.140','45.59.131.209','45.59.180.245','45.59.180.58','45.59.181.38','45.59.181.71','45.59.181.80','45.59.182.209','45.59.182.217','45.59.183.171','45.59.183.214','45.59.183.67','45.71.19.128','45.71.19.159','52.128.0.45','52.128.0.98','52.128.1.105','52.128.1.124','52.128.10.164','52.128.10.20','52.128.11.123','52.128.11.71','52.128.12.46','52.128.12.70','52.128.13.125','52.128.13.207','52.128.14.107','52.128.14.115','52.128.14.30','52.128.15.114','52.128.15.92','52.128.196.173','52.128.196.240','52.128.196.70','52.128.197.105','52.128.197.17','52.128.198.105','52.128.198.72','52.128.198.76','52.128.199.206','52.128.199.237','52.128.2.17','52.128.2.58','52.128.200.127','52.128.200.182','52.128.200.79','52.128.201.194','52.128.201.3','52.128.201.56','52.128.202.108','52.128.202.189','52.128.202.242','52.128.203.21','52.128.203.230','52.128.204.144','52.128.204.91','52.128.205.148','52.128.205.204','52.128.206.110','52.128.206.219','52.128.206.96','52.128.207.116','52.128.207.237','52.128.208.176','52.128.208.60','52.128.209.109','52.128.209.120','52.128.210.159','52.128.210.80','52.128.211.121','52.128.211.155','52.128.216.224','52.128.216.41','52.128.217.208','52.128.217.87','52.128.218.165','52.128.218.65','52.128.219.165','52.128.219.177','52.128.219.44','52.128.220.40','52.128.220.48','52.128.221.181','52.128.221.230','52.128.222.161','52.128.222.38','52.128.223.201','52.128.223.219','52.128.3.86','52.128.3.90','52.128.4.106','52.128.4.227','52.128.5.35','52.128.5.52','52.128.6.111','52.128.6.149','52.128.6.93','52.128.7.247','52.128.7.81','52.128.8.195','52.128.8.33','52.128.9.12','52.128.9.177','62.3.61.119','62.3.61.2','62.3.61.40','88.218.172.175','88.218.172.203','88.218.172.83','88.218.173.65','88.218.173.94','88.218.173.98','88.218.174.16','88.218.174.44','88.218.175.235','88.218.175.5','88.218.175.57','95.164.224.233','95.164.224.38','95.164.225.124','95.164.225.21','95.164.226.220','95.164.226.221','95.164.226.7','95.164.227.152','95.164.227.199','95.164.227.206','95.164.236.212','95.164.236.249','95.164.236.58','95.164.237.111','95.164.237.251','95.164.238.183','95.164.238.206','95.164.239.113','95.164.239.253']
proxy_iplum = ["lum-customer-c_127755f5-zone-us_zone-ip-205.237.95.118",
               "lum-customer-c_127755f5-zone-us_zone-ip-205.237.94.12",
               "lum-customer-c_127755f5-zone-us_zone-ip-205.237.93.15",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.138.24",
               "lum-customer-c_127755f5-zone-us_zone-ip-66.56.81.81",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.101.195",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.185.214",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.166.124",
               "lum-customer-c_127755f5-zone-us_zone-ip-216.19.221.179",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.174.51",
               "lum-customer-c_127755f5-zone-us_zone-ip-74.85.208.20",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.114.58",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.119.236",
               "lum-customer-c_127755f5-zone-us_zone-ip-198.240.89.44",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.199.211",
               "lum-customer-c_127755f5-zone-us_zone-ip-199.244.60.208",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.120.29",
               "lum-customer-c_127755f5-zone-us_zone-ip-74.85.210.146",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.124.31",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.115.29",
               "lum-customer-c_127755f5-zone-us_zone-ip-198.240.101.9",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.126.198",
               "lum-customer-c_127755f5-zone-us_zone-ip-67.213.122.166",
               "lum-customer-c_127755f5-zone-us_zone-ip-216.19.200.134",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.240.143",
               "lum-customer-c_127755f5-zone-us_zone-ip-216.19.199.1",
               "lum-customer-c_127755f5-zone-us_zone-ip-119.13.196.121",
               "lum-customer-c_127755f5-zone-us_zone-ip-91.92.218.14",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.113.199",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.131.157",
               "lum-customer-c_127755f5-zone-us_zone-ip-46.232.209.111",
               "lum-customer-c_127755f5-zone-us_zone-ip-119.13.217.58",
               "lum-customer-c_127755f5-zone-us_zone-ip-119.13.193.211",
               "lum-customer-c_127755f5-zone-us_zone-ip-180.149.17.222",
               "lum-customer-c_127755f5-zone-us_zone-ip-203.78.175.112",
               "lum-customer-c_127755f5-zone-us_zone-ip-188.119.117.166",
               "lum-customer-c_127755f5-zone-us_zone-ip-119.12.184.31",
               "lum-customer-c_127755f5-zone-us_zone-ip-94.176.59.134",
               "lum-customer-c_127755f5-zone-us_zone-ip-119.13.200.246",
               "lum-customer-c_127755f5-zone-us_zone-ip-119.12.203.25",
               "lum-customer-c_127755f5-zone-us_zone-ip-180.149.25.80",
               "lum-customer-c_127755f5-zone-us_zone-ip-188.211.24.139",
               "lum-customer-c_127755f5-zone-us_zone-ip-91.192.215.74",
               "lum-customer-c_127755f5-zone-us_zone-ip-119.12.202.151",
               "lum-customer-c_127755f5-zone-us_zone-ip-180.149.6.40",
               "lum-customer-c_127755f5-zone-us_zone-ip-180.149.26.196",
               "lum-customer-c_127755f5-zone-us_zone-ip-91.92.217.112",
               "lum-customer-c_127755f5-zone-us_zone-ip-193.200.104.140",
               "lum-customer-c_127755f5-zone-us_zone-ip-94.176.54.25",
               "lum-customer-c_127755f5-zone-us_zone-ip-180.149.2.89",
               "lum-customer-c_127755f5-zone-us_zone-ip-206.204.38.62",
               "lum-customer-c_127755f5-zone-us_zone-ip-213.188.83.143",
               "lum-customer-c_127755f5-zone-us_zone-ip-94.176.53.18",
               "lum-customer-c_127755f5-zone-us_zone-ip-91.245.235.235",
               "lum-customer-c_127755f5-zone-us_zone-ip-94.176.85.212",
               "lum-customer-c_127755f5-zone-us_zone-ip-78.138.40.246",
               "lum-customer-c_127755f5-zone-us_zone-ip-185.246.173.58",
               "lum-customer-c_127755f5-zone-us_zone-ip-119.12.198.227",
               "lum-customer-c_127755f5-zone-us_zone-ip-94.176.57.142",
               "lum-customer-c_127755f5-zone-us_zone-ip-94.176.60.18",
               "lum-customer-c_127755f5-zone-us_zone-ip-89.38.132.172",
               "lum-customer-c_127755f5-zone-us_zone-ip-213.188.76.146",
               "lum-customer-c_127755f5-zone-us_zone-ip-119.12.182.89",
               "lum-customer-c_127755f5-zone-us_zone-ip-94.176.51.212",
               "lum-customer-c_127755f5-zone-us_zone-ip-208.86.196.158",
               "lum-customer-c_127755f5-zone-us_zone-ip-168.151.179.15",
               "lum-customer-c_127755f5-zone-us_zone-ip-119.12.188.46",
               "lum-customer-c_127755f5-zone-us_zone-ip-213.188.75.89",
               "lum-customer-c_127755f5-zone-us_zone-ip-119.12.190.164",
               "lum-customer-c_127755f5-zone-us_zone-ip-213.188.68.39",
               "lum-customer-c_127755f5-zone-us_zone-ip-89.40.81.29",
               "lum-customer-c_127755f5-zone-us_zone-ip-185.223.56.108",
               "lum-customer-c_127755f5-zone-us_zone-ip-161.129.160.90",
               "lum-customer-c_127755f5-zone-us_zone-ip-213.188.88.130",
               "lum-customer-c_127755f5-zone-us_zone-ip-152.39.153.185",
               "lum-customer-c_127755f5-zone-us_zone-ip-119.13.205.38",
               "lum-customer-c_127755f5-zone-us_zone-ip-203.78.174.235",
               "lum-customer-c_127755f5-zone-us_zone-ip-206.204.49.106",
               "lum-customer-c_127755f5-zone-us_zone-ip-94.176.61.225",
               "lum-customer-c_127755f5-zone-us_zone-ip-180.149.23.229",
               "lum-customer-c_127755f5-zone-us_zone-ip-95.215.38.210",
               "lum-customer-c_127755f5-zone-us_zone-ip-209.95.161.115",
               "lum-customer-c_127755f5-zone-us_zone-ip-162.43.236.118",
               "lum-customer-c_127755f5-zone-us_zone-ip-45.142.97.199",
               "lum-customer-c_127755f5-zone-us_zone-ip-152.39.160.7",
               "lum-customer-c_127755f5-zone-us_zone-ip-119.13.221.75",
               "lum-customer-c_127755f5-zone-us_zone-ip-139.5.105.86",
               "lum-customer-c_127755f5-zone-us_zone-ip-180.149.0.122",
               "lum-customer-c_127755f5-zone-us_zone-ip-206.204.5.224",
               "lum-customer-c_127755f5-zone-us_zone-ip-203.109.62.114",
               "lum-customer-c_127755f5-zone-us_zone-ip-139.5.107.122",
               "lum-customer-c_127755f5-zone-us_zone-ip-84.39.228.157",
               "lum-customer-c_127755f5-zone-us_zone-ip-203.109.63.54",
               "lum-customer-c_127755f5-zone-us_zone-ip-95.215.37.169",
               "lum-customer-c_127755f5-zone-us_zone-ip-162.43.235.85",
               "lum-customer-c_127755f5-zone-us_zone-ip-152.39.214.9",
               "lum-customer-c_127755f5-zone-us_zone-ip-110.238.215.203",
               "lum-customer-c_127755f5-zone-us_zone-ip-162.43.229.39",
               "lum-customer-c_127755f5-zone-us_zone-ip-185.10.4.83",
               "lum-customer-c_127755f5-zone-us_zone-ip-216.194.92.180"]

port = '22225'
rand_ips = "zproxy.lum-superproxy.io"
rndusername = random.choice(proxy_iplum)
usern_passw = rndusername + ':dngrv4oofa9a'
proxy = {'https': "https://{}@{}:{}/".format(usern_passw, rand_ips, port)}

p1 = ['154.28.67.106', '154.28.67.111', '154.28.67.116', '154.28.67.117', '154.28.67.125',
              '154.28.67.131',
              '154.28.67.133', '154.28.67.142', '154.28.67.156', '154.28.67.163', '154.28.67.173',
              '154.28.67.18',
              '154.28.67.182', '154.28.67.184', '154.28.67.20', '154.28.67.200', '154.28.67.210',
              '154.28.67.218',
              '154.28.67.222', '154.28.67.223', '154.28.67.231', '154.28.67.240', '154.28.67.243',
              '154.28.67.253',
              '154.28.67.39', '154.28.67.4', '154.28.67.49', '154.28.67.5', '154.28.67.61', '154.28.67.80',
              '154.28.67.81', '154.28.67.87', '154.28.67.88', '154.28.67.96', '154.28.67.99', '154.7.230.100',
              '154.7.230.101', '154.7.230.103', '154.7.230.107', '154.7.230.109', '154.7.230.130',
              '154.7.230.132',
              '154.7.230.14', '154.7.230.140', '154.7.230.147', '154.7.230.151', '154.7.230.156',
              '154.7.230.163',
              '154.7.230.170', '154.7.230.18', '154.7.230.183', '154.7.230.188', '154.7.230.189',
              '154.7.230.19',
              '154.7.230.190', '154.7.230.198', '154.7.230.204', '154.7.230.209', '154.7.230.235',
              '154.7.230.238',
              '154.7.230.246', '154.7.230.29', '154.7.230.41', '154.7.230.42', '154.7.230.51', '154.7.230.55',
              '154.7.230.60', '154.7.230.61', '154.7.230.74', '154.7.230.82', '154.7.230.89', '23.131.8.112',
              '23.131.8.115', '23.131.8.117', '23.131.8.12', '23.131.8.121', '23.131.8.124', '23.131.8.150',
              '23.131.8.161', '23.131.8.166', '23.131.8.171', '23.131.8.173', '23.131.8.176', '23.131.8.177',
              '23.131.8.181', '23.131.8.19', '23.131.8.192', '23.131.8.194', '23.131.8.199', '23.131.8.202',
              '23.131.8.203', '23.131.8.204', '23.131.8.207', '23.131.8.209', '23.131.8.213', '23.131.8.216',
              '23.131.8.225', '23.131.8.228', '23.131.8.231', '23.131.8.238', '23.131.8.254', '23.131.8.36',
              '23.131.8.5', '23.131.8.76', '23.131.8.93', '23.131.8.95', '23.131.8.99', '23.131.88.105',
              '23.131.88.12', '23.131.88.137', '23.131.88.139', '23.131.88.140', '23.131.88.145',
              '23.131.88.150',
              '23.131.88.151', '23.131.88.153', '23.131.88.154', '23.131.88.156', '23.131.88.165',
              '23.131.88.18',
              '23.131.88.191', '23.131.88.192', '23.131.88.194', '23.131.88.198', '23.131.88.202',
              '23.131.88.206',
              '23.131.88.220', '23.131.88.223', '23.131.88.228', '23.131.88.233', '23.131.88.24',
              '23.131.88.242',
              '23.131.88.244', '23.131.88.47', '23.131.88.63', '23.131.88.67', '23.131.88.73', '23.131.88.80',
              '23.131.88.81', '23.131.88.82', '23.131.88.88', '23.131.88.97', '23.170.144.149',
              '23.170.144.209',
              '23.170.144.212', '23.170.144.242', '23.170.144.83', '23.170.145.117', '23.170.145.167',
              '23.170.145.182', '23.170.145.19', '23.170.145.203', '23.226.17.101', '23.226.17.109',
              '23.226.17.112', '23.226.17.113', '23.226.17.115', '23.226.17.123', '23.226.17.129',
              '23.226.17.143',
              '23.226.17.148', '23.226.17.165', '23.226.17.186', '23.226.17.199', '23.226.17.201',
              '23.226.17.207',
              '23.226.17.210', '23.226.17.219', '23.226.17.220', '23.226.17.222', '23.226.17.229',
              '23.226.17.250',
              '23.226.17.254', '23.226.17.26', '23.226.17.33', '23.226.17.4', '23.226.17.49', '23.226.17.5',
              '23.226.17.55', '23.226.17.66', '23.226.17.7', '23.226.17.72', '23.226.17.78', '23.226.17.8',
              '23.226.17.86', '23.226.17.90', '23.226.17.93', '23.230.177.105', '23.230.177.110',
              '23.230.177.113',
              '23.230.177.121', '23.230.177.130', '23.230.177.14', '23.230.177.143', '23.230.177.15',
              '23.230.177.150', '23.230.177.154', '23.230.177.165', '23.230.177.173', '23.230.177.191',
              '23.230.177.196', '23.230.177.203', '23.230.177.206', '23.230.177.208', '23.230.177.217',
              '23.230.177.220', '23.230.177.221', '23.230.177.224', '23.230.177.228', '23.230.177.231',
              '23.230.177.235', '23.230.177.237', '23.230.177.241', '23.230.177.27', '23.230.177.38',
              '23.230.177.52', '23.230.177.61', '23.230.177.67', '23.230.177.72', '23.230.177.80',
              '23.230.177.88',
              '23.230.177.94', '23.230.177.99', '23.230.197.103', '23.230.197.106', '23.230.197.109',
              '23.230.197.11', '23.230.197.12', '23.230.197.122', '23.230.197.124', '23.230.197.146',
              '23.230.197.155', '23.230.197.156', '23.230.197.174', '23.230.197.179', '23.230.197.181',
              '23.230.197.196', '23.230.197.2', '23.230.197.201', '23.230.197.207', '23.230.197.208',
              '23.230.197.225', '23.230.197.227', '23.230.197.233', '23.230.197.236', '23.230.197.239',
              '23.230.197.240', '23.230.197.244', '23.230.197.251', '23.230.197.50', '23.230.197.52',
              '23.230.197.54', '23.230.197.60', '23.230.197.71', '23.230.197.80', '23.230.197.81',
              '23.230.197.84',
              '23.230.197.97', '23.230.74.102', '23.230.74.110', '23.230.74.116', '23.230.74.125',
              '23.230.74.133',
              '23.230.74.135', '23.230.74.14', '23.230.74.141', '23.230.74.149', '23.230.74.15',
              '23.230.74.157',
              '23.230.74.16', '23.230.74.170', '23.230.74.172', '23.230.74.174', '23.230.74.183',
              '23.230.74.187',
              '23.230.74.19', '23.230.74.198', '23.230.74.208', '23.230.74.212', '23.230.74.215',
              '23.230.74.23',
              '23.230.74.230', '23.230.74.231', '23.230.74.252', '23.230.74.30', '23.230.74.41', '23.230.74.57',
              '23.230.74.58', '23.230.74.59', '23.230.74.6', '23.230.74.75', '23.230.74.81', '23.230.74.88',
              '23.230.74.91', '23.27.222.108', '23.27.222.109', '23.27.222.134', '23.27.222.138',
              '23.27.222.159',
              '23.27.222.161', '23.27.222.164', '23.27.222.166', '23.27.222.178', '23.27.222.19',
              '23.27.222.195',
              '23.27.222.201', '23.27.222.202', '23.27.222.203', '23.27.222.208', '23.27.222.21',
              '23.27.222.211',
              '23.27.222.218', '23.27.222.223', '23.27.222.228', '23.27.222.234', '23.27.222.236',
              '23.27.222.242',
              '23.27.222.251', '23.27.222.253', '23.27.222.34', '23.27.222.61', '23.27.222.62', '23.27.222.69',
              '23.27.222.70', '23.27.222.72', '23.27.222.73', '23.27.222.74', '23.27.222.81', '23.27.222.93',
              '38.131.131.110', '38.131.131.114', '38.131.131.123', '38.131.131.125', '38.131.131.137',
              '38.131.131.142', '38.131.131.145', '38.131.131.147', '38.131.131.15', '38.131.131.154',
              '38.131.131.16', '38.131.131.17', '38.131.131.173', '38.131.131.18', '38.131.131.193',
              '38.131.131.204', '38.131.131.207', '38.131.131.227', '38.131.131.229', '38.131.131.233',
              '38.131.131.238', '38.131.131.246', '38.131.131.248', '38.131.131.250', '38.131.131.31',
              '38.131.131.36', '38.131.131.50', '38.131.131.58', '38.131.131.64', '38.131.131.70',
              '38.131.131.71',
              '38.131.131.74', '38.131.131.83', '38.131.131.94', '38.131.131.99', '38.75.75.104',
              '38.75.75.111',
              '38.75.75.112', '38.75.75.119', '38.75.75.120', '38.75.75.123', '38.75.75.127', '38.75.75.139',
              '38.75.75.14', '38.75.75.143', '38.75.75.155', '38.75.75.156', '38.75.75.158', '38.75.75.170',
              '38.75.75.179', '38.75.75.188', '38.75.75.2', '38.75.75.201', '38.75.75.231', '38.75.75.232',
              '38.75.75.241', '38.75.75.246', '38.75.75.251', '38.75.75.26', '38.75.75.29', '38.75.75.4',
              '38.75.75.44', '38.75.75.49', '38.75.75.56', '38.75.75.58', '38.75.75.62', '38.75.75.72',
              '38.75.75.76', '38.75.75.79', '38.75.75.88', '38.96.156.108', '38.96.156.112', '38.96.156.128',
              '38.96.156.131', '38.96.156.14', '38.96.156.142', '38.96.156.143', '38.96.156.149',
              '38.96.156.16',
              '38.96.156.163', '38.96.156.165', '38.96.156.169', '38.96.156.186', '38.96.156.188',
              '38.96.156.190',
              '38.96.156.192', '38.96.156.194', '38.96.156.199', '38.96.156.218', '38.96.156.236',
              '38.96.156.240',
              '38.96.156.252', '38.96.156.28', '38.96.156.32', '38.96.156.35', '38.96.156.56', '38.96.156.57',
              '38.96.156.6', '38.96.156.67', '38.96.156.77', '38.96.156.80', '38.96.156.83', '38.96.156.84',
              '38.96.156.89', '38.96.156.92', '45.238.157.100', '45.238.157.104', '45.238.157.106',
              '45.238.157.110', '45.238.157.116', '45.238.157.118', '45.238.157.119', '45.238.157.12',
              '45.238.157.123', '45.238.157.132', '45.238.157.14', '45.238.157.149', '45.238.157.15',
              '45.238.157.183', '45.238.157.186', '45.238.157.189', '45.238.157.2', '45.238.157.212',
              '45.238.157.214', '45.238.157.217', '45.238.157.22', '45.238.157.228', '45.238.157.23',
              '45.238.157.247', '45.238.157.43', '45.238.157.48', '45.238.157.51', '45.238.157.52',
              '45.238.157.53',
              '45.238.157.56', '45.238.157.61', '45.238.157.65', '45.238.157.72', '45.238.157.79',
              '45.238.157.8',
              '45.238.159.103', '45.238.159.107', '45.238.159.110', '45.238.159.114', '45.238.159.116',
              '45.238.159.123', '45.238.159.126', '45.238.159.144', '45.238.159.148', '45.238.159.15',
              '45.238.159.156', '45.238.159.165', '45.238.159.167', '45.238.159.183', '45.238.159.20',
              '45.238.159.208', '45.238.159.217', '45.238.159.220', '45.238.159.23', '45.238.159.230',
              '45.238.159.235', '45.238.159.237', '45.238.159.238', '45.238.159.24', '45.238.159.249',
              '45.238.159.251', '45.238.159.32', '45.238.159.34', '45.238.159.51', '45.238.159.6',
              '45.238.159.66',
              '45.238.159.77', '45.238.159.79', '45.238.159.82', '45.238.159.91']
p_auth = str("csimonra:h19VA2xZ")
p_host = random.choice(p1)
p_port = "29842"
proxy1 = {
            'http': "https://{}@{}:{}/".format(p_auth, p_host, p_port),
            'https': "http://{}@{}:{}/".format(p_auth, p_host, p_port)
        }

List_1 = []
import pandas as pd
data_record = []
def by_product_id(prod_id_data, n):

    global sku_id, prod_url, final_sku_id, html_file_path
    print(prod_id_data)
    dict_1 = {'Website': 'FOOTLOCKER',
              'Country': 'DE',
              'Category ID': '',
              'Page ID': '',
              'Category URL': '',
              'SKU_ID': '',
              'PDP URL': '',
              'Date_&_TimeStamp': '',
              'Cache Page': ''
             }


    """
    p_auth = str("csimonra:h19VA2xZ")
    p_host = random.choice(p1)
    p_port = "29842"

    proxy = {
        'http': "https://{}@{}:{}/".format(p_auth, p_host, p_port),
        'https': "http://{}@{}:{}/".format(p_auth, p_host, p_port)
    }
    #proxy={
    #    'http':'http://belfast.wonderproxy.com:11000',
    #    'https': 'http://coventry.wonderproxy.com:11000',
    #}
    #auth=HTTPProxyAuth("ecxpremier"	,"eCxpremier123")
    """
    first_response = requests.get(prod_id_data[0], headers=new_header,proxies=proxy1,timeout=30)
    no_of_pages = []

    if first_response.status_code == 200:
        first_tree = html.fromstring(first_response.text)
       # cache_data = first_response.text
        #html_file_path = html_cache_page_saving(sku=str(prod_id_data[1]), saving_data=cache_data)

        no_products = first_tree.xpath(
            '//div[@class="Heading ProductSearch-summary"]/h2[@class="Heading-main font-caption"]/strong[2]/text()[2]')[
            0]
        print(no_products)
        calculation = int(no_products) / 48
        print(calculation)
        import math
        no_of_pages.append(math.ceil(calculation))

    key = prod_id_data[0].split('/')[-1].replace('.html', '')
    for page_num in range(0, no_of_pages[0]):

        api_url = 'https://www.footlocker.de/api/products/search?query={}&currentPage={}&sort=relevance&pageSize=48&timestamp=4'.format(
            key, page_num)


        page_id = prod_id_data[1] + '_' + str(page_num + 1)
        if page_num==0:
            cat_url=prod_id_data[0]
        else:
            cat_url=prod_id_data[0]+f'?currentPage={str(page_num)}'

        # print(api_keywrd)
        try:
            """
            p_auth1 = str("csimonra:h19VA2xZ")
            p_host1= random.choice(p1)
            p_port = "29842"
            proxy1 = {
                'http': "https://{}@{}:{}/".format(p_auth, p_host1, p_port),
                'https': "http://{}@{}:{}/".format(p_auth, p_host1, p_port)
            }
            """



            response = requests.get(url=api_url, headers=new_header,proxies=proxy, timeout=30)
            print(response.status_code)

            cache_data = response.text
            html_file_path = html_cache_page_saving(sku=page_id, saving_data=cache_data)
            l1=[]
            l2=[]

            l3=[]
            json_data = json.loads(response.text)
            for data in json_data['products']:
                sku_id = data['sku']

                l1.append(sku_id)

                #sku=json_data['products'][sku]
                # print(sku_id)
                #for i in l1:
                prod_url = 'https://www.footlocker.de/de/product/~/{}.html'.format(sku_id)
                l2.append(prod_url)
                #print(prod_url)
                final_sku_id = 'footlocker_de_{}'.format(sku_id)
                l3.append(final_sku_id)
                #print(final_sku_id)
                #print(page_id)

            # print(l1)
            # print(l2)
            # print(l3)
            #exit()

        except Exception as e:
            print("proxy_error")
        #now = datetime.now()
        for a,b,c in zip(l1,l2,l3):

            dict_1['Category ID'] = prod_id_data[1]
            dict_1['Page ID'] = page_id
            dict_1['Category URL'] = cat_url
            dict_1['SKU_ID'] = c
            dict_1['PDP URL'] =b
            dict_1['Date_&_TimeStamp'] = time.strftime("%Y-%m-%dT%H:%M:%SZ")
            dict_1['Cache Page'] = html_file_path
            print(dict_1)
            # data_record.append()
            store_data_in_csv([dict_1])
            # print(data_dict)
            # date_time1 = datetime.now().strftime("%m-%d-%Y")
            # data_record = data_record.append(dict_1, ignore_index=True)
            # data_record.to_csv(f'Zalando_FR_ASS_{date_time1}.csv', encoding='utf-8',
            #                    columns=['Website', 'Country', 'Category ID',
            #                             'Page ID', 'Category_URL', 'SKU_ID',
            #                             'PDP URL', 'Date_&_TimeStamp', 'Cache Page'],
            #                    index=False)




for data in extract_xl():
    print('inside 1')
    by_product_id(prod_id_data=data, n=3)

